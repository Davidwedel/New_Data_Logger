<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Data Logger</title>
<style>
  body { font-family: sans-serif; }
  .tab-container { display: flex; border-bottom: 2px solid #ccc; }
  .tab {
    padding: 10px 20px;
    cursor: pointer;
    border: 1px solid #ccc;
    border-bottom: none;
    background: #eee;
    margin-right: 2px;
    border-top-left-radius: 6px;
    border-top-right-radius: 6px;
  }
  .tab.active { background: white; font-weight: bold; }
  .tab-content { border: 1px solid #ccc; padding: 20px; background: white; }
  .tab-pane { display: none; }
  .tab-pane.active { display: block; }
</style>
</head>
<body>

<div class="tab-container">
  <div class="tab active" onclick="openTab('dailyentry')">Daily Entry</div>
  <div class="tab" onclick="openTab('palletentry')">Pallet Entry</div>
  <div class="tab" onclick="openTab('dailylog')">Daily Log</div>
  <div class="tab" onclick="openTab('palletlog')">Pallet Log</div>
  <!--<div class="tab" onclick="openTab('win3')">Window 3</div>-->
</div>

<div class="tab-content">
  <div id="dailyentry" class="tab-pane active">This is content for window 1.</div>
  <div id="palletentry" class="tab-pane">Here’s window 2 content.</div>

 <!-- Daily Log Tab -->
  <div id="dailylog" class="tab-pane">
    <table id="dailylog-table" border="1">
      <thead>
        <tr>
          <th>Timestamp</th>
          <th>Date</th>
          <th>Feed Consumption</th>
          <th>Body Weight</th>
        </tr>
      </thead>
      <tbody>
        <!-- rows will be inserted here by JS -->
      </tbody>
    </table>
  </div>

  <div id="palletlog" class="tab-pane">Here’s window 2 content.</div>
  <!--<div id="win3" class="tab-pane">And this is window 3.</div>-->
</div>


<script>
function openTab(tabId) {
    // Hide all tab panes
    document.querySelectorAll('.tab-pane').forEach(p => p.classList.remove('active'));
    // Remove active class from all tabs
    document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));

    // Show selected tab
    const pane = document.getElementById(tabId);
    if (pane) pane.classList.add('active');

    // Highlight selected tab
    const tab = Array.from(document.querySelectorAll('.tab')).find(t => t.getAttribute('onclick').includes(tabId));
    if (tab) tab.classList.add('active');

    // Load daily log if that tab is opened
    if (tabId === 'dailylog') {
        loadDailyLog();
    }
}

async function loadDailyLog() {
    try {
        const response = await fetch('/api/dailylog');
        const logs = await response.json();
        const tbody = document.querySelector("#dailylog-table tbody");
        tbody.innerHTML = ""; // clear existing rows

        logs.forEach(log => {
            const row = document.createElement("tr");
            row.innerHTML = `
                <td>${log.timestamp}</td>
                <td>${log.date}</td>
                <td>${log.feed}</td>
                <td>${log.weight}</td>
            `;
            tbody.appendChild(row);
        });
    } catch (err) {
        console.error("Failed to load daily log:", err);
    }
}

// Optionally load the tab that is active on page load
window.addEventListener("DOMContentLoaded", () => {
    const activePane = document.querySelector(".tab-pane.active");
    if (activePane && activePane.id === "dailylog") {
        loadDailyLog();
    }
});
</script>

</body>
</html>
