<div id="settings" class="tabcontent" style="display:none;">
  <h2>Farm Settings</h2>
  <form id="settingsForm" onsubmit="saveSettings(event)">
    <div class="spinner-container">
      <span class="spinner-label">Hatch Date</span>
      <input type="date" id="hatchDate" name="hatchDate">
    </div>
    <div class="spinner-container">
      <span class="spinner-label">Birds Arrived Date</span>
      <input type="date" id="birdsArrivedDate" name="birdsArrivedDate">
    </div>
    <div class="spinner-container">
      <span class="spinner-label">NWS Station ID</span>
      <input type="text" id="nws_station_id" name="nws_station_id" placeholder="e.g. KBOS" maxlength="4" style="text-transform:uppercase;">
    </div>
    <p style="font-size:12px; color:#666; margin-left:160px;">Enter your nearest NWS station ID for auto-weather. Leave blank to disable.<br>Find stations at <a href="https://www.weather.gov/" target="_blank">weather.gov</a></p>
    <button type="submit" class="floating-btn" style="position:static; margin-top:20px;">Save Settings</button>
    <div id="settingsMsg" style="margin-top:10px;"></div>
  </form>
</div>

<script>
  function saveSettings(event) {
    event.preventDefault();
    const hatchDate = document.getElementById('hatchDate').value;
    const birdsArrivedDate = document.getElementById('birdsArrivedDate').value;
    const nwsStationId = document.getElementById('nws_station_id').value.toUpperCase();
    fetch('/save_settings', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({
        hatch_date: hatchDate,
        birds_arrived_date: birdsArrivedDate,
        nws_station_id: nwsStationId
      })
    })
      .then(res => res.json())
      .then(data => {
        document.getElementById('settingsMsg').textContent = data.message || 'Settings saved!';
      })
      .catch(() => {
        document.getElementById('settingsMsg').textContent = 'Error saving settings.';
      });
  }
</script>
